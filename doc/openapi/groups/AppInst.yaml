# Auto-generated doc: DO NOT EDIT
openapi: 3.0.3
info:
  description: Master Controller APIs for AppInsts
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  title: AppInst APIs
  version: "2.0"
servers:
- description: localhost server
  url: http://localhost:9900
paths:
  /api/v1/auth/ctrl/CreateAppInst:
    post:
      description: Create Application Instance. Creates an instance of an App on a
        Cloudlet where it is defined by an App plus a ClusterInst key. Many of the
        fields here are inherited from the App definition.
      operationId: CreateAppInst
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrmapiRegionAppInst'
            x-required-fields:
            - region
            - appinst.key.name
            - appinst.key.organization
            - appinst.key.cloudletkey.organization
            - appinst.key.cloudletkey.name
            - appinst.key.cloudletkey.federatedorganization
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EdgeprotoResult'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrmapiResult'
          description: Bad Request
        "403":
          description: Forbidden
      security:
      - bearerAuth: []
      summary: CreateAppInst
      tags:
      - AppInst
  /api/v1/auth/ctrl/DeleteAppInst:
    post:
      description: Delete Application Instance. Deletes an instance of the App from
        the Cloudlet.
      operationId: DeleteAppInst
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrmapiRegionAppInst'
            x-required-fields:
            - region
            - appinst.key.name
            - appinst.key.organization
            - appinst.key.cloudletkey.organization
            - appinst.key.cloudletkey.name
            - appinst.key.cloudletkey.federatedorganization
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EdgeprotoResult'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrmapiResult'
          description: Bad Request
        "403":
          description: Forbidden
      security:
      - bearerAuth: []
      summary: DeleteAppInst
      tags:
      - AppInst
  /api/v1/auth/ctrl/RefreshAppInst:
    post:
      description: Refresh Application Instance. Restarts an App instance with new
        App settings or image.
      operationId: RefreshAppInst
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrmapiRegionAppInst'
            x-required-fields:
            - region
            - appinst.key.name
            - appinst.key.organization
            - appinst.key.cloudletkey.organization
            - appinst.key.cloudletkey.name
            - appinst.key.cloudletkey.federatedorganization
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EdgeprotoResult'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrmapiResult'
          description: Bad Request
        "403":
          description: Forbidden
      security:
      - bearerAuth: []
      summary: RefreshAppInst
      tags:
      - AppInst
  /api/v1/auth/ctrl/ShowAppInst:
    post:
      description: Show Application Instances. Lists all the Application instances
        managed by the Edge Controller. Any fields specified will be used to filter
        results.
      operationId: ShowAppInst
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrmapiRegionAppInst'
            x-required-fields:
            - region
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EdgeprotoAppInst'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrmapiResult'
          description: Bad Request
        "403":
          description: Forbidden
      security:
      - bearerAuth: []
      summary: ShowAppInst
      tags:
      - AppInst
  /api/v1/auth/ctrl/UpdateAppInst:
    post:
      description: Update Application Instance. Updates an Application instance and
        then refreshes it.
      operationId: UpdateAppInst
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrmapiRegionAppInst'
            x-required-fields:
            - region
            - appinst.key.name
            - appinst.key.organization
            - appinst.key.cloudletkey.organization
            - appinst.key.cloudletkey.name
            - appinst.key.cloudletkey.federatedorganization
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EdgeprotoResult'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrmapiResult'
          description: Bad Request
        "403":
          description: Forbidden
      security:
      - bearerAuth: []
      summary: UpdateAppInst
      tags:
      - AppInst
components:
  schemas:
    DmeProtoAppPort:
      properties:
        end_port:
          description: A non-zero end port indicates a port range from internal port
            to end port, inclusive.
          type: integer
        fqdn_prefix:
          description: FQDN prefix to append to base FQDN in FindCloudlet response.
            May be empty.
          type: string
        internal_port:
          description: Container port
          type: integer
        max_pkt_size:
          description: Maximum datagram size (udp only)
          type: integer
        nginx:
          description: Use nginx proxy for this port if you really need a transparent
            proxy (udp only)
          type: boolean
        proto:
          $ref: '#/components/schemas/DmeProtoLProto'
        public_port:
          description: Public facing port for TCP/UDP (may be mapped on shared LB
            reverse proxy)
          type: integer
        tls:
          description: TLS termination for this port
          type: boolean
      type: object
    DmeProtoHealthCheck:
      type: integer
    DmeProtoLProto:
      type: integer
    DmeProtoLoc:
      properties:
        altitude:
          description: On android only lat and long are guaranteed to be supplied
            Altitude in meters
          type: number
        course:
          description: Course (IOS) / bearing (Android) (degrees east relative to
            true north)
          type: number
        horizontal_accuracy:
          description: Horizontal accuracy (radius in meters)
          type: number
        latitude:
          description: Latitude in WGS 84 coordinates
          type: number
        longitude:
          description: Longitude in WGS 84 coordinates
          type: number
        speed:
          description: Speed (IOS) / velocity (Android) (meters/sec)
          type: number
        timestamp:
          $ref: '#/components/schemas/DmeProtoTimestamp'
        vertical_accuracy:
          description: Vertical accuracy (meters)
          type: number
      type: object
    DmeProtoTimestamp:
      properties:
        nanos:
          description: Added non-negative sub-second time in nanoseconds
          type: integer
        seconds:
          description: Time in seconds since epoch
          type: integer
      type: object
    EdgeprotoAppInst:
      properties:
        app_key:
          $ref: '#/components/schemas/EdgeprotoAppKey'
        auto_cluster_ip_access:
          description: (Deprecated) IpAccess for auto-clusters. Ignored otherwise.,
            valid values are one of Unknown, Dedicated, Shared, or 0, 1, 3
          type: string
        availability_zone:
          description: Optional Availability Zone if any
          type: string
        cloudlet_flavor:
          description: Cloudlet-specific flavor instead of regional flavor
          type: string
        cloudlet_loc:
          $ref: '#/components/schemas/DmeProtoLoc'
        cluster_key:
          $ref: '#/components/schemas/EdgeprotoClusterKey'
        compatibility_version:
          description: Internal compatibility version
          minimum: 0
          type: integer
        configs:
          description: Customization files passed through to implementing services
          items:
            $ref: '#/components/schemas/EdgeprotoConfigFile'
          type: array
        created_at:
          description: Created at time
          type: string
        crm_override:
          description: Override actions to CRM, valid values are one of NoOverride,
            IgnoreCrmErrors, IgnoreCrm, IgnoreTransientState, IgnoreCrmAndTransientState,
            or 0, 1, 2, 3, 4
          type: string
        dedicated_ip:
          description: Dedicated IP assigns an IP for this AppInst but requires platform
            support
          type: boolean
        dns_label:
          description: DNS label that is unique within the cloudlet and among other
            AppInsts/ClusterInsts
          type: string
        errors:
          description: Any errors trying to create, update, or delete the AppInst
            on the Cloudlet
          items:
            type: string
          type: array
        external_volume_size:
          description: Size of external volume to be attached to nodes.  This is for
            the root partition
          minimum: 0
          type: integer
        fed_key:
          $ref: '#/components/schemas/EdgeprotoFedAppInstKey'
        flavor:
          $ref: '#/components/schemas/EdgeprotoFlavorKey'
        force_update:
          description: Force Appinst refresh even if revision number matches App revision
            number.
          type: boolean
        health_check:
          $ref: '#/components/schemas/DmeProtoHealthCheck'
        internal_port_to_lb_ip:
          additionalProperties:
            type: string
          description: mapping of ports to load balancer IPs
          type: object
        key:
          $ref: '#/components/schemas/EdgeprotoAppInstKey'
        liveness:
          description: Liveness of instance (see Liveness), valid values are one of
            Unknown, Static, Dynamic, Autoprov, or 0, 1, 2, 3
          type: string
        mapped_ports:
          description: For instances accessible via a shared load balancer, defines
            the external ports on the shared load balancer that map to the internal
            ports External ports should be appended to the Uri for L4 access.
          items:
            $ref: '#/components/schemas/DmeProtoAppPort'
          nullable: true
          type: array
        opt_res:
          description: Optional Resources required by OS flavor if any
          type: string
        power_state:
          description: Power State of the AppInst, valid values are one of PowerStateUnknown,
            PowerOnRequested, PoweringOn, PowerOn, PowerOffRequested, PoweringOff,
            PowerOff, RebootRequested, Rebooting, Reboot, PowerStateError, or 0, 1,
            2, 3, 4, 5, 6, 7, 8, 9, 10
          type: string
        real_cluster_name:
          description: (_deprecated_) Real ClusterInst name
          type: string
        revision:
          description: Revision changes each time the App is updated.  Refreshing
            the App Instance will sync the revision with that of the App
          type: string
        runtime_info:
          $ref: '#/components/schemas/EdgeprotoAppInstRuntime'
        state:
          description: Current state of the AppInst on the Cloudlet, valid values
            are one of TrackedStateUnknown, NotPresent, CreateRequested, Creating,
            CreateError, Ready, UpdateRequested, Updating, UpdateError, DeleteRequested,
            Deleting, DeleteError, DeletePrepare, CrmInitok, CreatingDependencies,
            DeleteDone, or 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
          type: string
        unique_id:
          description: A unique id for the AppInst within the region to be used by
            platforms
          type: string
        update_multiple:
          description: Allow multiple instances to be updated at once
          type: boolean
        updated_at:
          description: Updated at time
          type: string
        uri:
          description: Base FQDN (not really URI) for the App. See Service FQDN for
            endpoint access.
          type: string
        virtual_cluster_key:
          $ref: '#/components/schemas/EdgeprotoClusterKey'
        vm_flavor:
          description: OS node flavor to use
          type: string
      type: object
    EdgeprotoAppInstKey:
      properties:
        cloudlet_key:
          $ref: '#/components/schemas/EdgeprotoCloudletKey'
        name:
          description: App Instance name
          type: string
        organization:
          description: App Instance organization
          type: string
      type: object
    EdgeprotoAppInstRuntime:
      properties:
        container_ids:
          description: List of container names
          items:
            type: string
          type: array
      type: object
    EdgeprotoAppKey:
      properties:
        name:
          description: App name
          type: string
        organization:
          description: App developer organization
          type: string
        version:
          description: App version
          type: string
      type: object
    EdgeprotoCloudletKey:
      properties:
        federated_organization:
          description: Federated operator organization who shared this cloudlet
          type: string
        name:
          description: Name of the cloudlet
          type: string
        organization:
          description: Organization of the cloudlet site
          type: string
      type: object
    EdgeprotoClusterKey:
      properties:
        name:
          description: Cluster name
          type: string
        organization:
          description: Name of the organization that this cluster belongs to
          type: string
      type: object
    EdgeprotoConfigFile:
      properties:
        config:
          description: Config file contents or URI reference
          type: string
        kind:
          description: Kind (type) of config, i.e. envVarsYaml, helmCustomizationYaml
          type: string
      type: object
    EdgeprotoFedAppInstKey:
      properties:
        app_inst_id:
          description: Federated AppInst ID
          type: string
        federation_name:
          description: Federation name
          type: string
      type: object
    EdgeprotoFlavorKey:
      properties:
        name:
          description: Flavor name
          type: string
      type: object
    EdgeprotoResult:
      properties:
        code:
          description: Error code, 0 indicates success, non-zero indicates failure
            (not implemented)
          type: integer
        message:
          description: Message, may be success or failure message
          type: string
      type: object
    OrmapiRegionAppInst:
      properties:
        AppInst:
          $ref: '#/components/schemas/EdgeprotoAppInst'
        Region:
          description: Region name
          type: string
      type: object
    OrmapiResult:
      properties:
        code:
          description: Error code
          type: integer
        message:
          description: Informational message
          type: string
      type: object
  securitySchemes:
    bearerAuth:
      bearerFormat: JWT
      description: JWT token generated by the login API to be included in the http
        header
      scheme: bearer
      type: http
